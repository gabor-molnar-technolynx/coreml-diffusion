<!<!DOCTYPE html>
<html>
    <header>
        <title>ONNX Runtime JavaScript examples: Quick Start - Web (using script tag)</title>
    </header>
    <body>
        <p id="demo"></p>
        <!-- import ONNXRuntime Web from CDN -->
<!--        <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>-->
        <script src="https://cdn.jsdelivr.net/npm/@microsoft/onnxruntime-web/dist/ort-web-webgl.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.0.0/dist/tf.min.js"></script>
<!--        <script src="https://cdn.jsdelivr.net/npm/onnxjs/dist/onnx.min.js"></script>-->
<!--        <script src="https://cdn.jsdelivr.net/npm/onnxjs@0.1.7/dist/onnx.min.js"></script>-->


        <script>
            // use an async context to call onnxruntime functions.
            async function main() {
                try {

                    const modelUrl = '../model/model.onnx';
                    const session = await ort.InferenceSession.create(modelUrl);

                    var  data_img = new Float32Array(64 * 64 * 3);
                    var  data_t = new BigInt64Array (1);
                    const tensor_img = new ort.Tensor('float32', data_img, [1,3,64,64]);
                    const tensor_t = new ort.Tensor('int64', data_t, [1]);

                    const feeds = { img_input: tensor_img, timestep_input: tensor_t }
                    const start = Date.now();
                    const results = await session.run(feeds);
                    const end = Date.now();
                    console.log(`Execution time: ${end - start} ms`);
                    console.log("results from session.run");
                    console.log(results)
                    // read from results
                    const dataC = results.noise_prediction.data;
                    document.write(`data of result tensor 'data': ${dataC}`);

                } catch (e) {
                    document.write(`failed to inference ONNX model: ${e}.`);
                }
            }

            main();
        </script>


    </body>
</html>